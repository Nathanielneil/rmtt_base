# RoboMaster TT技术规格与传感器说明

## 硬件规格

### 主控制器
- **型号**: ESP32-D2WD
- **CPU**: 双核Xtensa LX6，主频240MHz
- **内存**: 520KB SRAM + 4MB PSRAM
- **无线通信**: 802.11b/g/n WiFi (2.4GHz)
- **工作温度**: -40°C ~ +85°C

### 传感器配置

#### 1. 高度定位系统 (双重定高)
- **红外TOF距离传感器**
  - 测量范围: 0.1m - 8.0m
  - 精度: ±3cm (近距离) / ±1% (远距离)
  - 更新频率: 50Hz
  - 特点: 近距离高精度，不受光照影响

- **气压计高度传感器**
  - 测量范围: -40m ~ +9000m (相对海平面)
  - 分辨率: 0.12hPa (约1cm高度)
  - 精度: ±1m (标准大气条件)
  - 特点: 绝对高度参考，不受地面材质影响

#### 2. 惯性测量单元 (IMU)
- **6轴IMU**: 3轴陀螺仪 + 3轴加速度计
- **角速度范围**: ±2000°/s
- **加速度范围**: ±16g
- **数据输出频率**: 100Hz
- **温度补偿**: 内置温度传感器校正

#### 3. 其他传感器
- **温度传感器**: 内置，监控系统温度
- **电池电量监测**: 实时电压检测
- **WiFi信号强度**: ESP32内置RSSI检测

## 传感器融合算法

### 高度估算
RoboMaster TT使用以下融合策略：

1. **近距离(0-2m)**: 主要使用TOF红外传感器
   - 优势: 厘米级精度，响应速度快
   - 用途: 起降阶段精确控制

2. **中远距离(2-8m)**: TOF + 气压计融合
   - 权重分配: TOF 60% + 气压计 40%
   - 优势: 综合精度和稳定性

3. **超远距离(>8m)**: 主要使用气压计
   - 气压计提供连续高度参考
   - TOF超出量程时的备用方案

### 运动状态估算
ESP32实时计算以下运动参数：

- **速度分量**: 通过IMU积分和高度微分计算
- **加速度分量**: 直接来自加速度计，经过重力补偿
- **姿态角度**: 陀螺仪和加速度计融合，互补滤波

## 数据输出格式

### 状态字符串格式
ESP32通过UDP端口8890发送状态字符串，典型格式：
```
mid:-1;x:0;y:0;z:0;mpry:0,0,0;pitch:0;roll:0;yaw:0;vgx:0;vgy:0;vgz:0;templ:55;temph:57;tof:10;h:0;bat:100;baro:25.12;time:0;agx:0;agy:0;agz:-1000;
```

### 关键字段说明
- `pitch`, `roll`, `yaw`: 姿态角度 (度)
- `vgx`, `vgy`, `vgz`: 三轴速度分量 (cm/s)
- `agx`, `agy`, `agz`: 三轴加速度分量 (0.001g单位)
- `tof`: TOF距离传感器读数 (cm)
- `baro`: 气压计高度 (cm，相对起飞点)
- `h`: 融合高度估算 (cm)
- `bat`: 电池电量 (百分比)
- `templ`, `temph`: 低温和高温读数 (°C)

## 性能特点

### 优势
1. **双重定高**: TOF + 气压计提供冗余保护
2. **高精度**: 近距离厘米级定位精度
3. **高频率**: 50Hz数据更新，适合精确控制
4. **实时处理**: ESP32边缘计算，减少延迟
5. **环境适应**: 不同传感器适应不同环境条件

### 限制
1. **TOF范围**: 红外TOF最大8米，超出需依赖气压计
2. **气压敏感**: 气压计受环境气压变化影响
3. **WiFi依赖**: 控制和数据传输依赖WiFi连接稳定性
4. **电池续航**: 高频数据采集消耗较多电量

## 最佳使用实践

### 实验环境
1. **室内**: 利用TOF高精度优势，适合精确高度控制
2. **室外**: 注意风力对气压计的影响
3. **地面材质**: TOF对不同材质反射率敏感

### 数据采集建议
1. **采样频率**: 推荐50Hz，平衡精度和性能
2. **数据校验**: 对比TOF和气压计读数检测异常
3. **连接监控**: 监测WiFi信号强度确保数据完整性
4. **电池管理**: 监控电量，低电量时影响传感器性能

### 故障诊断
- **高度跳跃**: 可能是传感器切换或环境干扰
- **数据缺失**: 检查WiFi连接和ESP32状态
- **精度下降**: 检查传感器清洁度和环境条件
- **频率不稳**: 可能是ESP32负载过高或电量不足

## 与标准Tello的区别

| 特性 | 标准Tello | RoboMaster TT |
|------|----------|---------------|
| 主控 | 单核ARM | 双核ESP32-D2WD |
| 定高传感器 | 单一TOF | TOF + 气压计双重定高 |
| 数据频率 | 10Hz | 50Hz |
| 速度数据 | 有限 | 完整三轴速度 |
| 加速度数据 | 基础 | 高精度三轴加速度 |
| WiFi监控 | 无 | ESP32集成信号监控 |
| 扩展性 | 有限 | 支持更多传感器扩展 |

这使得RoboMaster TT在精确控制、数据采集和科研应用方面具有明显优势。